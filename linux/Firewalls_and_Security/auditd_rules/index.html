<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Auditd rules - My Docs</title>
  

  <link rel="shortcut icon" href="../../../img/favicon.ico">

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../../css/highlight.css">

  
  <script>
    // Current page data
    var mkdocs_page_name = "Auditd rules";
  </script>
  
  <script src="../../../js/jquery-2.1.1.min.js"></script>
  <script src="../../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../../js/highlight.pack.js"></script>
  <script src="../../../js/theme.js"></script> 

  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../../.." class="icon icon-home"> My Docs</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <ul class="current">
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../../..">Home</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../../../map/">Map</a>
        
    </li>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Programming</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../programming/map/">Map</a>
        
    </li>

        
            
    <ul class="subnav">
    <li><span>C programming</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../programming/c_programming/fork_and_maloc_demo/">Fork and maloc demo</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../programming/c_programming/fork_demo_menu/">Fork demo menu</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../programming/c_programming/linux_clocksource_benchmark/">Linux clocksource benchmark</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../programming/c_programming/programmable_keyboard/">Programmable keyboard</a>
        
    </li>

        
    </ul>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Puppet</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../puppet/puppet_study_notes/">Puppet study notes</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Scripting</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../scripting/Column_tally/">Column tally</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../scripting/Convert_kilobytes_to_MB_GB_TB_PB/">Convert kilobytes to MB GB TB PB</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../scripting/DNS_validate_entries/">DNS validate entries</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../scripting/IP_survey/">IP survey</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../scripting/Shuffle_deck_of_cards/">Shuffle deck of cards</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../scripting/bash_and_grep_script_to_compare_2_lists/">Bash and grep script to compare 2 lists</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../scripting/bash_argument_shift_until_loop/">Bash argument shift until loop</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../scripting/bash_argument_shift_while_loop/">Bash argument shift while loop</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../scripting/bash_arguments/">Bash arguments</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../scripting/bash_capture_keyboard_entry/">Bash capture keyboard entry</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../scripting/bash_case/">Bash case</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../scripting/bash_fail_and_exit/">Bash fail and exit</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../scripting/bash_fail_trap/">Bash fail trap</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../scripting/bash_function/">Bash function</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../scripting/bash_functions/">Bash functions</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../scripting/bash_local_vs_global_variables/">Bash local vs global variables</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../scripting/bash_nested_if_else/">Bash nested if else</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../scripting/bash_read_input/">Bash read input</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../scripting/bash_scripting/">Bash scripting</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../scripting/bash_select/">Bash select</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../scripting/bash_sort/">Bash sort</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../scripting/bash_string_comparison/">Bash string comparison</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../scripting/bash_test_to_only_run_as_root/">Bash test to only run as root</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../scripting/bash_tips/">Bash tips</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../scripting/bash_trap_user_ctrl-c/">Bash trap user ctrl c</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../scripting/bash_wait_for_user_input/">Bash wait for user input</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../scripting/diff/">Diff</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../scripting/expect/">Expect</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../scripting/map/">Map</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../scripting/script_to_markdown/">Script to markdown</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../scripting/simulate_site_failure/">Simulate site failure</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../scripting/use_a_file_to_control_bash_script_operation/">Use a file to control bash script operation</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Linux</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../hot_add_memory_and_cpus/">Hot add memory and cpus</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../linux_proccess_signaling/">Linux proccess signaling</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../map/">Map</a>
        
    </li>

        
            
    <ul class="subnav">
    <li><span>Networking</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Networking/check_dns_records/">Check dns records</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Networking/determine_the_routes_a_packet_will_take/">Determine the routes a packet will take</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Networking/linux_networking/">Linux networking</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Networking/local_IP_address_survey/">local IP address survey</a>
        
    </li>

        
    </ul>

        
            
    <ul class="subnav">
    <li><span>Firewalls and Security</span></li>

        
            
    <li class="toctree-l1 current">
        <a class="current" href="./">Auditd rules</a>
        
            <ul>
            
                <li class="toctree-l3"><a href="#using-auuditd-and-aureport-on-rhel-to-track-whats-going-on">Using auuditd and aureport on RHEL to track whats going on.</a></li>
                
            
                <li class="toctree-l3"><a href="#restart-the-auditd-daemon">restart the auditd daemon</a></li>
                
                    <li><a class="toctree-l4" href="#some-extra-audit-rules-to-monitor-changes-to-the-file-system-warning-these-will-be-very-noisy-on-a-busy-system">some extra audit rules to monitor changes to the file system. Warning these will be very noisy on a busy system</a></li>
                
            
                <li class="toctree-l3"><a href="#retrieving-info-from-the-audit-system">retrieving info from the audit system</a></li>
                
            
            </ul>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../iptables_notes/">Iptables notes</a>
        
    </li>

        
    </ul>

        
            
    <ul class="subnav">
    <li><span>Software Packaging</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Software_Packaging/apt_get/">Apt get</a>
        
    </li>

        
    </ul>

        
            
    <ul class="subnav">
    <li><span>Core Utils</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Core_Utils/awk/">Awk</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Core_Utils/bash_shortcuts/">Bash shortcuts</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Core_Utils/rename/">Rename</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Core_Utils/spacecmd_breaking_up_large_groups_of_hosts_with_awk/">Spacecmd breaking up large groups of hosts with awk</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Core_Utils/user_creation/">User creation</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Core_Utils/watch_and_timeout/">Watch and timeout</a>
        
    </li>

        
    </ul>

        
            
    <ul class="subnav">
    <li><span>Clustering</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Clustering/HA_LVM_automatic_failover/">HA LVM automatic failover</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Clustering/HA_LVM_automatic_failover_manual_fence_override/">HA LVM automatic failover manual fence override</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Clustering/HA_LVM_cluster_build/">HA LVM cluster build</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Clustering/HA_LVM_cluster_build_guide/">HA LVM cluster build guide</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Clustering/HA_LVM_manual_failover.txt/">HA LVM manual failover.txt</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Clustering/RHEL4_cluster_installation/">RHEL4 cluster installation</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Clustering/cluster_website/">Cluster website</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Clustering/homemade_cluster/">Homemade cluster</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Clustering/simple.cluster.conf/">Simple.cluster.conf</a>
        
    </li>

        
    </ul>

        
            
    <ul class="subnav">
    <li><span>Time</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Time/Adventures_in_the_land_of_symmetric_ntp_authentication/">Adventures in the land of symmetric ntp authentication</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Time/Setting_time/">Setting time</a>
        
    </li>

        
    </ul>

        
            
    <ul class="subnav">
    <li><span>RedHat</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../RedHat/kickstart/">Kickstart</a>
        
    </li>

        
            
    <ul class="subnav">
    <li><span>Satellite spacewalk</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../RedHat/satellite_spacewalk/perl_script_to_calulate_uptime_of_satellite_clients/">Perl script to calulate uptime of satellite clients</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../RedHat/satellite_spacewalk/replacing_your_satellite_certificate/">Replacing your satellite certificate</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../RedHat/satellite_spacewalk/satellite_certificate_licence_install/">Satellite certificate licence install</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../RedHat/satellite_spacewalk/using_spacecmd/">Using spacecmd</a>
        
    </li>

        
    </ul>

        
            
    <ul class="subnav">
    <li><span>Yum rpm</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../RedHat/yum_rpm/create_local_repos_from_redhat_install_media/">Create local repos from redhat install media</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../RedHat/yum_rpm/working_with_yum_and_rpm/">Working with yum and rpm</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../RedHat/yum_rpm/yum_and_rpm/">Yum and rpm</a>
        
    </li>

        
    </ul>

        
    </ul>

        
            
    <ul class="subnav">
    <li><span>Commands</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Commands/email_on_linux/">Email on linux</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Commands/hot_add_memory/">Hot add memory</a>
        
    </li>

        
    </ul>

        
            
    <ul class="subnav">
    <li><span>Monitoring</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Monitoring/nagios_2.6_install/">Nagios 2.6 install</a>
        
    </li>

        
    </ul>

        
            
    <ul class="subnav">
    <li><span>Disks and File Systems</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Disks_and_File_Systems/Extend_lvm_filesystem/">Extend lvm filesystem</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Disks_and_File_Systems/Linux_LVM_Logical_Volume_Manager/">Linux LVM Logical Volume Manager</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Disks_and_File_Systems/Listing_Oracle_ASM_disks/">Listing Oracle ASM disks</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Disks_and_File_Systems/Multipath_and_NetApp_fixes/">Multipath and NetApp fixes</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Disks_and_File_Systems/Online_lun_resize/">Online lun resize</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Disks_and_File_Systems/RHEL_floppy_kickstart/">RHEL floppy kickstart</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Disks_and_File_Systems/boot_cdrom_dvdrom/">Boot cdrom dvdrom</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Disks_and_File_Systems/disk_filesystem_partition_imaging_using_squashfs_and_dd/">Disk filesystem partition imaging using squashfs and dd</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Disks_and_File_Systems/filesystem_shuffle/">Filesystem shuffle</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Disks_and_File_Systems/rsync/">Rsync</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Disks_and_File_Systems/shrink_lvm_filesystem/">Shrink lvm filesystem</a>
        
    </li>

        
    </ul>

        
    </ul>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../..">My Docs</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../..">Docs</a> &raquo;</li>
    
      
        
          <li>Firewalls and Security &raquo;</li>
        
      
    
    <li>Auditd rules</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h3 id="using-auuditd-and-aureport-on-rhel-to-track-whats-going-on">Using auuditd and aureport on RHEL to track whats going on.</h3>
<p>Generate list of SUID programs</p>
<pre><code>for SUID_BIN in `find / -xdev \( -perm -4000 \) -type f -print`
do AUDIT_CMD="auditctl -A exit,always -F  path="
AUDIT_PERM="-pxwra"
KEY=`echo $SUID_BIN | awk  -F\/ '{  print "-k key-suid-"$NF }'`
echo $AUDIT_CMD$SUID_BIN" "$AUDIT_PERM $KEY 
done
</code></pre>
<p>Backup the existing audit rules</p>
<pre><code>cd /etc/audit/
cp audit.rules audit.rules.orig &amp;&amp;  vi audit.rules
</code></pre>
<p>Sample audit rules</p>
<pre><code>#Attempts to perform unauthorised functions
#-a exit,always  -F arch=b64 -F success!=0 -S open -k key-fopen-failure

#Additions, deletions and modifications to security/audit log parameters

#-a exit,always -F dir=/var/log -F perm=wa -k key-writes-access-var-log

#Critical file changes
#Activity performed by privileged accounts Modifications to system settings (parameters)
-w /etc/ -p w -k key-file-change-etc


#The authority and access to use advanced operating system utilities and commands that bypass system access controls must be monitored, logged, reviewed and restricted to those individuals who require access to perform their job functions.
auditctl -A exit,always -F path=/opt/google/chrome/chrome-sandbox -pxwra -k key-suid-chrome-sandbox
auditctl -A exit,always -F path=/usr/sbin/pppd -pxwra -k key-suid-pppd
auditctl -A exit,always -F path=/usr/sbin/uuidd -pxwra -k key-suid-uuidd
auditctl -A exit,always -F path=/usr/lib/dbus-1.0/dbus-daemon-launch-helper -pxwra -k key-suid-dbus-daemon-launch-helper
auditctl -A exit,always -F path=/usr/lib/virtualbox/VBoxSDL -pxwra -k key-suid-VBoxSDL
auditctl -A exit,always -F path=/usr/lib/virtualbox/VBoxNetAdpCtl -pxwra -k key-suid-VBoxNetAdpCtl
auditctl -A exit,always -F path=/usr/lib/virtualbox/VirtualBox -pxwra -k key-suid-VirtualBox
auditctl -A exit,always -F path=/usr/lib/virtualbox/VBoxHeadless -pxwra -k key-suid-VBoxHeadless
auditctl -A exit,always -F path=/usr/lib/virtualbox/VBoxNetDHCP -pxwra -k key-suid-VBoxNetDHCP
auditctl -A exit,always -F path=/usr/lib/x86_64-linux-gnu/oxide-qt/chrome-sandbox -pxwra -k key-suid-chrome-sandbox
auditctl -A exit,always -F path=/usr/lib/policykit-1/polkit-agent-helper-1 -pxwra -k key-suid-polkit-agent-helper-1
auditctl -A exit,always -F path=/usr/lib/eject/dmcrypt-get-device -pxwra -k key-suid-dmcrypt-get-device
auditctl -A exit,always -F path=/usr/lib/pt_chown -pxwra -k key-suid-pt_chown
auditctl -A exit,always -F path=/usr/lib/openssh/ssh-keysign -pxwra -k key-suid-ssh-keysign
auditctl -A exit,always -F path=/usr/bin/traceroute6.iputils -pxwra -k key-suid-traceroute6.iputils
auditctl -A exit,always -F path=/usr/bin/chfn -pxwra -k key-suid-chfn
auditctl -A exit,always -F path=/usr/bin/pkexec -pxwra -k key-suid-pkexec
auditctl -A exit,always -F path=/usr/bin/passwd -pxwra -k key-suid-passwd
auditctl -A exit,always -F path=/usr/bin/X -pxwra -k key-suid-X
auditctl -A exit,always -F path=/usr/bin/fping -pxwra -k key-suid-fping
auditctl -A exit,always -F path=/usr/bin/chsh -pxwra -k key-suid-chsh
auditctl -A exit,always -F path=/usr/bin/fping6 -pxwra -k key-suid-fping6
auditctl -A exit,always -F path=/usr/bin/mtr -pxwra -k key-suid-mtr
auditctl -A exit,always -F path=/usr/bin/gpasswd -pxwra -k key-suid-gpasswd
auditctl -A exit,always -F path=/usr/bin/sudo -pxwra -k key-suid-sudo
auditctl -A exit,always -F path=/usr/bin/lppasswd -pxwra -k key-suid-lppasswd
auditctl -A exit,always -F path=/usr/bin/newgrp -pxwra -k key-suid-newgrp
auditctl -A exit,always -F path=/home/guess/.pia_manager/openvpn_launcher.64 -pxwra -k key-suid-openvpn_launcher.64
auditctl -A exit,always -F path=/home/guess/.pia_manager/openvpn_launcher.32 -pxwra -k key-suid-openvpn_launcher.32
auditctl -A exit,always -F path=/bin/mount -pxwra -k key-suid-mount
auditctl -A exit,always -F path=/bin/ping6 -pxwra -k key-suid-ping6
auditctl -A exit,always -F path=/bin/fusermount -pxwra -k key-suid-fusermount
auditctl -A exit,always -F path=/bin/umount -pxwra -k key-suid-umount
auditctl -A exit,always -F path=/bin/su -pxwra -k key-suid-su
auditctl -A exit,always -F path=/bin/ping -pxwra -k key-suid-ping
</code></pre>
<h3 id="restart-the-auditd-daemon">restart the auditd daemon</h3>
<pre><code>service auditd restart

tail -f /var/log/audit/audit.log
</code></pre>
<h4 id="some-extra-audit-rules-to-monitor-changes-to-the-file-system-warning-these-will-be-very-noisy-on-a-busy-system">some extra audit rules to monitor changes to the file system. Warning these will be very noisy on a busy system</h4>
<pre><code>-a always,exit -F arch=b32 -S chmod -F auid&gt;=500 -F auid!=4294967295 -k perm_mod
-a always,exit -F path=/bin/chmod -F auid&gt;=500 -F auid!=4294967295 -k perm_mod
-a always,exit -F arch=b64 -S unlink -S unlinkat -S rename -S renameat -F auid&gt;=500 -F auid!=4294967295 -k delete
-a always,exit -F arch=b64 -S creat -S open -S openat -S truncate -S ftruncate -F exit=-EACCES -F auid&gt;=500 -F auid!=4294967295 -k access
-a always,exit -F arch=b64 -S creat -S open -S openat -S truncate -S ftruncate -F exit=-EPERM -F auid&gt;=500 -F auid!=4294967295 -k access

(host=example1np OR host=example2np) source="/var/log/audit/audit.log" index="os_secure"
host=example1np  source="/var/log/audit/audit.log" index="os_secure"
</code></pre>
<h3 id="retrieving-info-from-the-audit-system">retrieving info from the audit system</h3>
<pre><code>aureport

Summary Report
======================
Range of time in logs: 5/08/2015 15:52:22 - 5/08/2015 18:43:12
Selected time for report: 5/08/2015 15:52:22 - 5/08/2015 18:43:12
Number of changes in configuration: 0
Number of changes to accounts, groups, or roles: 0
Number of logins: 0
Number of failed logins: 0
Number of authentications: 17
Number of failed authentications: 0
Number of users: 2
Number of terminals: 2
Number of host names: 2
Number of executables: 25
Number of files: 28649
Number of AVC's: 0
Number of MAC events: 0
Number of failed syscalls: 512
Number of anomaly events: 0
Number of responses to anomaly events: 0
Number of crypto events: 39
Number of keys: 5
Number of process IDs: 1234
Number of events: 23455
</code></pre>
<p>defining a time range</p>
<pre><code>aureport  -ts 12/06/2013 09:00:09.082 -te 12/06/2013 10:21:27.308
</code></pre>
              
            </div>
          </div>
          

<footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      <!--  <a href="../iptables_notes/" class="btn btn-neutral float-right" title="Iptables notes"/>Next <span class="icon icon-circle-arrow-right"></span></a> -->
        <a href="../iptables_notes/index.html" class="btn btn-neutral float-right" title="Iptables notes">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
      <!-- <a href="../../Networking/local_IP_address_survey/" class="btn btn-neutral" title="local IP address survey"><span class="icon icon-circle-arrow-left"></span> Previous</a> -->
        <a href="../../Networking/local_IP_address_survey/index.html" class="btn btn-neutral" title="local IP address survey"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  <!-- Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. -->
</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../../Networking/local_IP_address_survey/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../iptables_notes/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>

</body>
</html>
